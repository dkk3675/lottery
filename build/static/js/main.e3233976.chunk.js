(this["webpackJsonplottery-react"]=this["webpackJsonplottery-react"]||[]).push([[0],{23:function(e,t,n){},24:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var a=n(9),r=n.n(a),s=n(15),c=n.n(s),i=(n(23),n(3)),o=n(8),u=n(4),l=n(5),p=n(18),h=n(17),b=(n(24),n(16)),d=n.n(b);window.ethereum.request({method:"eth_requestAccounts"});var m=new d.a(window.ethereum),j=new m.eth.Contract([{constant:!0,inputs:[],name:"manager",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"pickWinner",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!0,inputs:[],name:"getPlayers",outputs:[{name:"",type:"address[]"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"winner",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"enter",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"players",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"}],"0x2c06AFe194FA2942DDcF9DabCaB9B79E2DF396F3"),y=n(35),f=n.p+"static/media/lottery.1bae6b1d.png",v=n(2),O=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={manager:"",players:[],balance:"",value:"",message:"--",previousWinner:"--",button:!0},e.onSubmit=function(){var t=Object(o.a)(Object(i.a)().mark((function t(n){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),!(e.state.value<=.01)){t.next=4;break}return alert("Ether of value greater than 0.01 ether is required to enter"),t.abrupt("return");case 4:return e.setState({button:!1}),t.next=7,m.eth.getAccounts();case 7:return a=t.sent,e.setState({message:"Wait for transaction to complete..."}),t.next=11,j.methods.enter().send({from:a[0],value:m.utils.toWei(e.state.value,"ether")}).then(function(){var t=Object(o.a)(Object(i.a)().mark((function t(n){var a,r;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({message:"Transaction completed with Transaction ID - ".concat(n.transactionHash,".")}),t.next=3,j.methods.getPlayers().call();case 3:return a=t.sent,t.next=6,m.eth.getBalance(j.options.address);case 6:r=t.sent,e.setState({players:a,balance:r,value:""});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.setState({message:"Transaction Aborted by User."})}));case 11:e.setState({button:!0});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onClick=Object(o.a)(Object(i.a)().mark((function t(){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.eth.getAccounts();case 2:if((n=t.sent)[0]===e.state.manager){t.next=6;break}return alert("You do not have the authority."),t.abrupt("return");case 6:if(0!==e.state.players.length){t.next=9;break}return alert("No players found."),t.abrupt("return");case 9:return e.setState({button:!1}),e.setState({message:"Wait for transaction to complete..."}),t.next=13,j.methods.pickWinner().send({from:n[0]}).then(function(){var t=Object(o.a)(Object(i.a)().mark((function t(n){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.methods.winner().call().then(function(){var t=Object(o.a)(Object(i.a)().mark((function t(n){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=(new Date).toLocaleString("en",{timeZoneName:"long",timeZone:"IST",weekday:"short",year:"numeric",month:"short",day:"numeric",hour12:!0,hour:"numeric",minute:"numeric",second:"numeric"}),t.next=3,y.a.post("http://lottery-backend.ap-south-1.elasticbeanstalk.com",{winner:n,no_of_participations:e.state.players.length,value:m.utils.fromWei(e.state.balance,"ether")}).then((function(t){e.setState({players:[],balance:"",message:"A winner has been picked.",previousWinner:"".concat(t.data.winner," [ declared on ").concat(a," ] won ").concat(t.data.value," ether")})})).catch((function(e){return console.log(e)}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.setState({message:"Winner is not picked yet as per manager's preferences."})}));case 13:e.setState({button:!0});case 14:case"end":return t.stop()}}),t)}))),e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(){var t,n,a,r,s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.methods.manager().call();case 2:return t=e.sent,e.next=5,j.methods.getPlayers().call();case 5:return n=e.sent,e.next=8,m.eth.getBalance(j.options.address);case 8:return a=e.sent,e.next=11,y.a.get("http://lottery-backend.ap-south-1.elasticbeanstalk.com").catch((function(e){return console.log(e)}));case 11:r=e.sent,s=new Date(r.data.createdAt),this.setState({manager:t,players:n,balance:a,previousWinner:r.data.id?"".concat(r.data.winner," [ declared on ").concat(s.toLocaleString("en",{timeZoneName:"long",timeZone:"IST",weekday:"short",year:"numeric",month:"short",day:"numeric",hour12:!0,hour:"numeric",minute:"numeric",second:"numeric"})," ] won ").concat(r.data.value," ether"):"--"});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{className:"App",children:[Object(v.jsx)("img",{src:f,alt:"",className:"img"}),Object(v.jsx)("h2",{children:"LOTTERY CONTRACT"}),Object(v.jsxs)("p",{children:["The manager of this contract is ",Object(v.jsx)("b",{children:this.state.manager}),". There are currently ",Object(v.jsxs)("b",{children:[this.state.players.length," people"]})," entered, competing to win ",Object(v.jsxs)("b",{children:[m.utils.fromWei(this.state.balance,"ether")," ethers"]}),"."]}),Object(v.jsx)("hr",{}),Object(v.jsxs)("form",{onSubmit:this.onSubmit,children:[Object(v.jsx)("h4",{children:"Want to try ur luck?"}),Object(v.jsxs)("div",{children:[Object(v.jsx)("label",{children:"Amount of ether to enter"}),"\xa0\xa0",Object(v.jsx)("input",{placeholder:"enter value > 0.01 ether",value:this.state.value,onChange:function(t){return e.setState({value:t.target.value})},required:!0})]}),Object(v.jsx)("br",{}),Object(v.jsx)("button",{disabled:!this.state.button,children:"Enter"})]}),Object(v.jsx)("hr",{}),Object(v.jsx)("h4",{children:"Time to pick a Winner"}),Object(v.jsx)("button",{onClick:this.onClick,disabled:!this.state.button,children:"Pick a Winner"}),Object(v.jsx)("hr",{}),Object(v.jsx)("h3",{children:this.state.message}),Object(v.jsx)("hr",{}),Object(v.jsxs)("h4",{children:["Recent Winner : ",this.state.previousWinner]})]})}}]),n}(r.a.Component),x=O;c.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(x,{})}),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.e3233976.chunk.js.map