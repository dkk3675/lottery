{"version":3,"sources":["web3.js","lottery.js","lottery.png","App.js","index.js"],"names":["window","ethereum","request","method","web3","Web3","contract","eth","Contract","constant","inputs","name","outputs","type","payable","stateMutability","App","state","manager","players","balance","value","message","previousWinner","button","onSubmit","event","preventDefault","alert","setState","getAccounts","accounts","lottery","methods","enter","send","from","utils","toWei","then","details","transactionHash","getPlayers","call","getBalance","options","address","catch","err","onClick","length","pickWinner","winner","timestamp","Date","toLocaleString","timeZoneName","timeZone","weekday","year","month","day","hour12","hour","minute","second","axios","post","process","no_of_participations","fromWei","response","data","console","log","get","createdAt","this","id","className","src","Lottery","alt","placeholder","onChange","target","required","disabled","React","Component","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.a4744cb6.chunk.js","sourcesContent":["import Web3 from 'web3';\r\n\r\nwindow.ethereum.request({ method: 'eth_requestAccounts' });\r\nlet web3 = new Web3(window.ethereum);\r\n// console.log(web3);\r\n\r\nexport default web3;","import web3 from \"./web3\";\r\n\r\nconst address = \"0x0BDb2c0e18A5376af7339b768f3CBF5A0d6b0db4\";\r\nconst abi = [\r\n  {\r\n    constant: true,\r\n    inputs: [],\r\n    name: \"manager\",\r\n    outputs: [\r\n      {\r\n        name: \"\",\r\n        type: \"address\",\r\n      },\r\n    ],\r\n    payable: false,\r\n    stateMutability: \"view\",\r\n    type: \"function\",\r\n  },\r\n  {\r\n    constant: false,\r\n    inputs: [],\r\n    name: \"pickWinner\",\r\n    outputs: [],\r\n    payable: true,\r\n    stateMutability: \"payable\",\r\n    type: \"function\",\r\n  },\r\n  {\r\n    constant: true,\r\n    inputs: [],\r\n    name: \"getPlayers\",\r\n    outputs: [\r\n      {\r\n        name: \"\",\r\n        type: \"address[]\",\r\n      },\r\n    ],\r\n    payable: false,\r\n    stateMutability: \"view\",\r\n    type: \"function\",\r\n  },\r\n  {\r\n    constant: true,\r\n    inputs: [],\r\n    name: \"winner\",\r\n    outputs: [\r\n      {\r\n        name: \"\",\r\n        type: \"address\",\r\n      },\r\n    ],\r\n    payable: false,\r\n    stateMutability: \"view\",\r\n    type: \"function\",\r\n  },\r\n  {\r\n    constant: false,\r\n    inputs: [],\r\n    name: \"enter\",\r\n    outputs: [],\r\n    payable: true,\r\n    stateMutability: \"payable\",\r\n    type: \"function\",\r\n  },\r\n  {\r\n    constant: true,\r\n    inputs: [\r\n      {\r\n        name: \"\",\r\n        type: \"uint256\",\r\n      },\r\n    ],\r\n    name: \"players\",\r\n    outputs: [\r\n      {\r\n        name: \"\",\r\n        type: \"address\",\r\n      },\r\n    ],\r\n    payable: false,\r\n    stateMutability: \"view\",\r\n    type: \"function\",\r\n  },\r\n  {\r\n    inputs: [],\r\n    payable: false,\r\n    stateMutability: \"nonpayable\",\r\n    type: \"constructor\",\r\n  },\r\n];\r\nconst contract = new web3.eth.Contract(abi, address);\r\nexport default contract;\r\n","export default __webpack_public_path__ + \"static/media/lottery.1bae6b1d.png\";","import \"./App.css\";\nimport React from \"react\";\nimport web3 from './web3';\nimport lottery from './lottery';\nimport axios from \"axios\";\nimport Lottery from './lottery.png';\n\n\nclass App extends React.Component {\n  \n  state = { manager: '', players: [], balance: '', value: '', message: '--', previousWinner: '--', button: true };\n\n  async componentDidMount(){\n    const manager = await lottery.methods.manager().call();\n    const players = await lottery.methods.getPlayers().call();\n    const balance = await web3.eth.getBalance(lottery.options.address);\n    const winner = await axios.get(process.env.REACT_APP_SERVER)\n    .catch(err => console.log(err));\n\n    const timestamp = new Date(winner.data.createdAt);\n\n    this.setState({ manager: manager, players: players, balance: balance,previousWinner: (winner.data.id)?`${winner.data.winner} [ declared on ${timestamp.toLocaleString('en',{\n      timeZoneName: \"long\",\n      timeZone: 'IST',\n      weekday: \"short\",\n      year: \"numeric\",\n      month: \"short\",\n      day: \"numeric\",\n      hour12: true,\n      hour: \"numeric\",\n      minute: \"numeric\",\n      second: \"numeric\",\n    })} ] won ${winner.data.value} ether`:'--' });\n  };\n\n  onSubmit = async (event) => {\n    event.preventDefault();\n    if(this.state.value <= 0.01){\n      alert(`Ether of value greater than 0.01 ether is required to enter`)\n      return;\n    }\n    this.setState({ button: false });\n    const accounts = await web3.eth.getAccounts();\n    this.setState({ message: \"Wait for transaction to complete...\" });\n    await lottery.methods.enter().send({\n      from: accounts[0],\n      value: web3.utils.toWei(this.state.value,'ether')\n    }).then(async details => {\n      this.setState({ message: `Transaction completed with Transaction ID - ${details.transactionHash}.` });\n      const players = await lottery.methods.getPlayers().call();\n      const balance = await web3.eth.getBalance(lottery.options.address);\n      this.setState({ players: players,balance: balance,value: '' });\n    }).catch(err => {\n      this.setState({ message: \"Transaction Aborted by User.\" });\n    });\n    this.setState({ button: true });\n  };\n\n  onClick = async () => {\n    const accounts = await web3.eth.getAccounts();\n    // console.log(accounts);\n    if(accounts[0] !== this.state.manager){\n      alert('You do not have the authority.');\n      return;\n    }\n    if(this.state.players.length === 0){\n      alert('No players found.');\n      return;\n    }\n    this.setState({ button: false });\n    this.setState({ message: \"Wait for transaction to complete...\" });\n    await lottery.methods.pickWinner().send({\n      from: accounts[0]\n    }).then(async details => {\n      await lottery.methods.winner().call().then(async winner => {\n        const timestamp = new Date().toLocaleString('en',{\n          timeZoneName: \"long\",\n          timeZone: 'IST',\n          weekday: \"short\",\n          year: \"numeric\",\n          month: \"short\",\n          day: \"numeric\",\n          hour12: true,\n          hour: \"numeric\",\n          minute: \"numeric\",\n          second: \"numeric\",\n        });\n        await axios.post(process.env.REACT_APP_SERVER,{ \n          winner: winner,\n          no_of_participations: this.state.players.length,\n          value: web3.utils.fromWei(this.state.balance,'ether')\n        }).then(response => {\n          this.setState({ players: [], balance: '',message: 'A winner has been picked.',previousWinner: `${response.data.winner} [ declared on ${timestamp} ] won ${response.data.value} ether` });\n        }).catch(err => console.log(err));\n      });  \n    }).catch(err => {\n      this.setState({ message: \"Winner is not picked yet as per manager's preferences.\" });\n    });\n    this.setState({ button: true });\n  };\n\n  render() {\n    return (\n      <div className=\"App\">\n        <img src={Lottery} alt=\"\" className=\"img\" />\n        <h2>LOTTERY CONTRACT</h2>\n        <p>\n          The manager of this contract is <b>{this.state.manager}</b>.\n          There are currently <b>{this.state.players.length} people</b> entered, competing to win <b>{web3.utils.fromWei(this.state.balance,'ether')} ethers</b>.\n        </p>\n\n        <hr />\n\n        <form onSubmit={this.onSubmit}>\n          <h4>Want to try ur luck?</h4>\n          <div>\n            <label>Amount of ether to enter</label>&nbsp;&nbsp;\n            <input placeholder=\"enter value > 0.01 ether\" value={this.state.value} onChange={event => this.setState({ value: event.target.value })} required />\n          </div>\n          <br />\n          <button disabled={!this.state.button}>Enter</button>\n        </form>\n        <hr />\n        <h4>Time to pick a Winner</h4>\n        <button onClick={this.onClick} disabled={!this.state.button}>Pick a Winner</button>\n        <hr />\n        <h3>{this.state.message}</h3>\n        <hr />\n        <h4>Recent Winner : {this.state.previousWinner}</h4>\n      </div>\n    );\n  }\n}\nexport default App;","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}